local utils = {}

local ret = table.pack (pcall (require, "lfs"))

if ret[1] then
  local lfs = ret[2]
  function utils.list (path)
    local result = {}

    for file in lfs.dir (path) do
      table.insert (result, file)
    end

    return result
  end
else
  function utils.list (directory)
    local f = io.popen (string.format ("ls ./%s", directory or ""))
    local files = {}

    for name in f:lines () do -- This assumes a ls program wich prints every file on a new line
      table.insert (files, tostring(name))
    end

    local success, exitcause, number = f:close ()

    if not success then
      error (exitcause, number)
    else
      return files
    end
  end
end

-- Note this doesn't remove spaces at the start and end of a string, but replaces them with one space
-- TODO: Strip comments (single line and multiline)
function utils.strip (source)
  return source:gsub ("[%s\n\r\f\t]+"," ")
end

return utils
